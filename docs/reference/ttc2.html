<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Top-Trading-Cycles Algorithm for a two sided matching problem — ttc2 • matchingMarkets</title>

<link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.1/clipboard.min.js" integrity="sha256-hIvIxeqhGZF+VVeM55k0mJvWpQ6gTkWk3Emc+NmowYA=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Top-Trading-Cycles Algorithm for a two sided matching problem — ttc2" />

<meta property="og:description" content="Implements the school matching algorithm proposed in Abdulkadiroglu and Sonmez (2003) for a matching problem
in which both sides have preferences. Missing preferences are handled in the following ways: Suppose that a student only ranked colleges that are already matched
to other students. This student is removed from the matching process and a list with all unmatchable students is printed.
If full_return is set to TRUE, a vector with this students is returned as well.
Now suppose during the matching process a student points to a college that still has capacities but does not rank any more students.
We assume now that the college is indifferent over all other students (so we do not allow for free capacieties) and we match the student who wants to go there to the college." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">matchingMarkets</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Top-Trading-Cycles Algorithm for a two sided matching problem</h1>
    
    <div class="hidden name"><code>ttc2.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Implements the school matching algorithm proposed in Abdulkadiroglu and Sonmez (2003) for a matching problem
in which both sides have preferences. Missing preferences are handled in the following ways: Suppose that a student only ranked colleges that are already matched
to other students. This student is removed from the matching process and a list with all unmatchable students is printed.
If <code>full_return</code> is set to <code>TRUE</code>, a vector with this students is returned as well.
Now suppose during the matching process a student points to a college that still has capacities but does not rank any more students.
We assume now that the college is indifferent over all other students (so we do not allow for free capacieties) and we match the student who wants to go there to the college.</p>
    
    </div>

    <pre class="usage"><span class='fu'>ttc2</span>(<span class='kw'>nStudents</span> <span class='kw'>=</span> <span class='fu'>ncol</span>(<span class='no'>s.prefs</span>), <span class='kw'>nColleges</span> <span class='kw'>=</span> <span class='fu'>ncol</span>(<span class='no'>c.prefs</span>),
  <span class='kw'>s.prefs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>c.prefs</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nSlots</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>priority</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>123</span>, <span class='kw'>full_return</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>nStudents</th>
      <td><p>integer indicating the number of students in the matching problem. Defaults to <code>ncol(s.prefs)</code>.</p></td>
    </tr>
    <tr>
      <th>nColleges</th>
      <td><p>integer indicating the number of colleges in the matching problem. Defaults to <code>ncol(c.prefs)</code>.</p></td>
    </tr>
    <tr>
      <th>s.prefs</th>
      <td><p>matrix of dimension <code>nColleges</code> x <code>nStudents</code> with the jth column containing student j's ranking over colleges in decreasing order of preference (i.e. most preferred first).</p></td>
    </tr>
    <tr>
      <th>c.prefs</th>
      <td><p>matrix of dimension <code>nStudents</code> x <code>nColleges</code> with the ith column containing college i's ranking over students in decreasing order of preference (i.e. most preferred first).</p></td>
    </tr>
    <tr>
      <th>nSlots</th>
      <td><p>vector of length <code>nColleges</code> indicating the number of places (i.e. quota) of each college.</p></td>
    </tr>
    <tr>
      <th>priority</th>
      <td><p>(Optional) vector of length <code>nStudents</code>. Gives the prioirity ordering of the students, if nothing is specified a random ordering is chosen.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>(Optional) integer setting the state for random number generation. Defaults to seed =123.</p></td>
    </tr>
    <tr>
      <th>full_return</th>
      <td><p>(Optinal) If <code>TRUE</code> the return value is a list with the matching, the remaining seats and the unmatchable students is returned. Defaults to <code>FALSE</code> and only the matching is returned.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>ttc2</code> returns a data frame of the matching of students (ind) to colleges (obj) for the school market problem based on the Top-Trading-Cycles algorithm.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Abdulkadiroglu, A. and T. Sonmez (2003). School Choice: A Mechanism Design Approach. <em>American Economic Review</em>, 93 (3): 729-747.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## 1-a. Compare example from the Abdulkadiroglu et al. (2003) (in the Appendix, page 742-744)</span>
<span class='co'>## 1-b. Generate matrix of students' preference rankings over schools, a.k.a. Rank Order Lists (ROL)</span>
<span class='no'>s.prefs</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>c</span>(
                  <span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,
                  <span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,
                  <span class='fl'>3</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>4</span>,
                  <span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,
                  <span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>2</span>,
                  <span class='fl'>4</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,
                  <span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,
                  <span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>3</span>),
                  <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>8</span>); <span class='no'>s.prefs</span></div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
#&gt; [1,]    2    1    3    3    1    4    1    1
#&gt; [2,]    1    2    2    4    3    1    2    2
#&gt; [3,]    3    3    1    1    4    2    3    4
#&gt; [4,]    4    4    4    2    2    3    4    3</div><div class='input'>

<span class='co'>## 1-c. Generate matrix of schools' preference rankings over students, a.k.a. Rank Order Lists (ROL)</span>
<span class='no'>c.prefs</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>c</span>(
                  <span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>6</span>,<span class='fl'>7</span>,<span class='fl'>8</span>,
                  <span class='fl'>3</span>,<span class='fl'>5</span>,<span class='fl'>4</span>,<span class='fl'>8</span>,<span class='fl'>7</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>6</span>,
                  <span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>7</span>,<span class='fl'>2</span>,<span class='fl'>8</span>,<span class='fl'>6</span>,<span class='fl'>4</span>,
                  <span class='fl'>6</span>,<span class='fl'>8</span>,<span class='fl'>7</span>,<span class='fl'>4</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>5</span>,<span class='fl'>1</span>),
                  <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>4</span>); <span class='no'>c.prefs</span></div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4]
#&gt; [1,]    1    3    5    6
#&gt; [2,]    2    5    3    8
#&gt; [3,]    3    4    1    7
#&gt; [4,]    4    8    7    4
#&gt; [5,]    5    7    2    2
#&gt; [6,]    6    2    8    3
#&gt; [7,]    7    1    6    5
#&gt; [8,]    8    6    4    1</div><div class='input'>
<span class='co'>## 1-d. Generate capacities</span>
<span class='no'>nSlots</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>3</span>)

<span class='co'>## 1-e. Find assignment based on TTC algorithm</span>
<span class='fu'>ttc2</span>(<span class='kw'>s.prefs</span> <span class='kw'>=</span> <span class='no'>s.prefs</span>, <span class='kw'>c.prefs</span> <span class='kw'>=</span> <span class='no'>c.prefs</span>, <span class='kw'>nSlots</span> <span class='kw'>=</span> <span class='no'>nSlots</span>)</div><div class='output co'>#&gt;   ind obj
#&gt; 1   1   2
#&gt; 2   2   1
#&gt; 3   3   3
#&gt; 4   4   3
#&gt; 5   5   1
#&gt; 6   6   4
#&gt; 7   7   2
#&gt; 8   8   4</div><div class='input'>

<span class='co'>## 2-a. Generate college preferences with college 1 only ranking student 1</span>
<span class='no'>c.prefs</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>c</span>(
                   <span class='fl'>1</span>,<span class='fu'>rep</span>(<span class='fl'>NA</span>,<span class='fl'>7</span>),
                   <span class='fl'>3</span>,<span class='fl'>5</span>,<span class='fl'>4</span>,<span class='fl'>8</span>,<span class='fl'>7</span>,<span class='fl'>2</span>,<span class='fl'>1</span>,<span class='fl'>6</span>,
                   <span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>7</span>,<span class='fl'>2</span>,<span class='fl'>8</span>,<span class='fl'>6</span>,<span class='fl'>4</span>,
                   <span class='fl'>6</span>,<span class='fl'>8</span>,<span class='fl'>7</span>,<span class='fl'>4</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>5</span>,<span class='fl'>1</span>),
                   <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>4</span>); <span class='no'>c.prefs</span></div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4]
#&gt; [1,]    1    3    5    6
#&gt; [2,]   NA    5    3    8
#&gt; [3,]   NA    4    1    7
#&gt; [4,]   NA    8    7    4
#&gt; [5,]   NA    7    2    2
#&gt; [6,]   NA    2    8    3
#&gt; [7,]   NA    1    6    5
#&gt; [8,]   NA    6    4    1</div><div class='input'>
<span class='co'>## 2-b. Find assignment based on TTC algorithm</span>
<span class='fu'>ttc2</span>(<span class='kw'>s.prefs</span> <span class='kw'>=</span> <span class='no'>s.prefs</span>, <span class='kw'>c.prefs</span> <span class='kw'>=</span> <span class='no'>c.prefs</span>, <span class='kw'>nSlots</span> <span class='kw'>=</span> <span class='no'>nSlots</span>, <span class='kw'>priority</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>8</span>)</div><div class='output co'>#&gt;   ind obj
#&gt; 1   1   2
#&gt; 2   2   1
#&gt; 3   3   3
#&gt; 4   4   3
#&gt; 5   5   1
#&gt; 6   6   4
#&gt; 7   7   2
#&gt; 8   8   4</div><div class='input'>

<span class='co'>## If all schools have the same preferences the two sided ttc and the serial dictator yield</span>
<span class='co'>## the same outcome if the preferences are taken to be the prioirty order for the serial dictator</span>

<span class='co'># Preferences are the same for all schools:</span>
<span class='no'>c.prefs</span> <span class='kw'>&lt;-</span> <span class='fu'>matrix</span>(<span class='fu'>c</span>(
                  <span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>7</span>,<span class='fl'>2</span>,<span class='fl'>8</span>,<span class='fl'>6</span>,<span class='fl'>4</span>,
                  <span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>7</span>,<span class='fl'>2</span>,<span class='fl'>8</span>,<span class='fl'>6</span>,<span class='fl'>4</span>,
                  <span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>7</span>,<span class='fl'>2</span>,<span class='fl'>8</span>,<span class='fl'>6</span>,<span class='fl'>4</span>,
                  <span class='fl'>5</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>7</span>,<span class='fl'>2</span>,<span class='fl'>8</span>,<span class='fl'>6</span>,<span class='fl'>4</span>),
                  <span class='kw'>byrow</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>4</span>)
<span class='no'>priority</span> <span class='kw'>&lt;-</span> <span class='no'>c.prefs</span>[,<span class='fl'>1</span>]

<span class='no'>match_ttc</span> <span class='kw'>&lt;-</span> <span class='fu'>ttc2</span>(<span class='kw'>s.prefs</span> <span class='kw'>=</span> <span class='no'>s.prefs</span>, <span class='kw'>c.prefs</span> <span class='kw'>=</span> <span class='no'>c.prefs</span>, <span class='kw'>nSlots</span> <span class='kw'>=</span> <span class='no'>nSlots</span>); <span class='no'>match_ttc</span></div><div class='output co'>#&gt;   ind obj
#&gt; 1   1   2
#&gt; 2   2   2
#&gt; 3   3   3
#&gt; 4   4   3
#&gt; 5   5   1
#&gt; 6   6   4
#&gt; 7   7   1
#&gt; 8   8   4</div><div class='input'><span class='no'>match_sd</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='rsd.html'>rsd</a></span>(<span class='kw'>prefs</span> <span class='kw'>=</span> <span class='no'>s.prefs</span>, <span class='kw'>priority</span> <span class='kw'>=</span> <span class='no'>priority</span>, <span class='kw'>nSlots</span> <span class='kw'>=</span> <span class='no'>nSlots</span>); <span class='no'>match_sd</span></div><div class='output co'>#&gt;   ind obj
#&gt; 1   1   2
#&gt; 2   2   2
#&gt; 3   3   3
#&gt; 4   4   3
#&gt; 5   5   1
#&gt; 6   6   4
#&gt; 7   7   1
#&gt; 8   8   4</div><div class='input'><span class='fu'>all</span>(<span class='no'>match_ttc</span> <span class='kw'>==</span> <span class='no'>match_sd</span>)</div><div class='output co'>#&gt; [1] TRUE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Thilo Klein, Alexander Sauer

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thilo Klein.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

